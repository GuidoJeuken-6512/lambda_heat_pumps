# Home Assistant Dashboard: Lambda native Register
# Anzeige: R{Register} : Name & Wert
# Nutzt Markdown-Karten mit Jinja-Template, damit state_attr(..., 'register') ausgewertet wird.
# In Entities-Karten wird "name:" NICHT als Template ausgewertet – daher Markdown + Template.
#
# Korrekte Syntax für Attribute (in Templates, die HA auswertet):
#   {{ state_attr('sensor.eu08l_ambient_error_number', 'register') }}
#   {{ states['sensor.eu08l_ambient_error_number'].attributes.get('register') }}
# expand("sensor.eu08l_...") erweitert Gruppen/Areas zu Entity-IDs, liefert keine Attribute.
# Prefix "eu08l" ggf. anpassen.

title: Lambda Register
views:
  - title: General (R0–R104)
    path: general
    icon: mdi:chip
    cards:
      - type: markdown
        title: General / Ambient & E-Manager
        content: |
          {% set list = [
            'sensor.eu08l_ambient_error_number',
            'sensor.eu08l_ambient_operating_state',
            'sensor.eu08l_ambient_temperature',
            'sensor.eu08l_ambient_temperature_1h',
            'sensor.eu08l_ambient_temperature_calculated',
            'sensor.eu08l_emgr_error_number',
            'sensor.eu08l_emgr_operating_state',
            'sensor.eu08l_emgr_actual_power',
            'sensor.eu08l_emgr_actual_power_consumption',
            'sensor.eu08l_emgr_power_consumption_setpoint'
          ] %}
          | Register | Name | Wert |
          |----------|------|------|
          {% for e in list %}
          {% if state_attr(e, 'register') is not none %}
          | R{{ state_attr(e, 'register') }} | {{ state_attr(e, 'friendly_name') or '—' }} | {{ states(e) }} {{ state_attr(e, 'unit_of_measurement') or '' }} |
          {% endif %}
          {% endfor %}

  - title: Wärmepumpe (HP1)
    path: hp1
    icon: mdi:heat-pump
    cards:
      - type: markdown
        title: HP1 – Native Register
        content: |
          {% set list = [
            'sensor.eu08l_hp1_error_state',
            'sensor.eu08l_hp1_error_number',
            'sensor.eu08l_hp1_state',
            'sensor.eu08l_hp1_operating_state',
            'sensor.eu08l_hp1_flow_line_temperature',
            'sensor.eu08l_hp1_return_line_temperature',
            'sensor.eu08l_hp1_volume_flow_heat_sink',
            'sensor.eu08l_hp1_energy_source_inlet_temperature',
            'sensor.eu08l_hp1_energy_source_outlet_temperature',
            'sensor.eu08l_hp1_volume_flow_energy_source',
            'sensor.eu08l_hp1_compressor_unit_rating',
            'sensor.eu08l_hp1_actual_heating_capacity',
            'sensor.eu08l_hp1_inverter_power_consumption',
            'sensor.eu08l_hp1_cop',
            'sensor.eu08l_hp1_request_type',
            'sensor.eu08l_hp1_requested_flow_line_temperature',
            'sensor.eu08l_hp1_requested_return_line_temperature',
            'sensor.eu08l_hp1_requested_flow_to_return_line_temperature_difference',
            'sensor.eu08l_hp1_relais_state_2nd_heating_stage',
            'sensor.eu08l_hp1_compressor_power_consumption_accumulated',
            'sensor.eu08l_hp1_compressor_thermal_energy_output_accumulated',
            'sensor.eu08l_hp1_config_parameter_24',
            'sensor.eu08l_hp1_vda_rating',
            'sensor.eu08l_hp1_hot_gas_temperature',
            'sensor.eu08l_hp1_subcooling_temperature',
            'sensor.eu08l_hp1_suction_gas_temperature',
            'sensor.eu08l_hp1_condensation_temperature',
            'sensor.eu08l_hp1_evaporation_temperature',
            'sensor.eu08l_hp1_eqm_rating',
            'sensor.eu08l_hp1_expansion_valve_opening_angle',
            'sensor.eu08l_hp1_config_parameter_33',
            'sensor.eu08l_hp1_config_parameter_50',
            'sensor.eu08l_hp1_dhw_output_power_15c',
            'sensor.eu08l_hp1_heating_min_output_power_15c',
            'sensor.eu08l_hp1_heating_max_output_power_15c',
            'sensor.eu08l_hp1_heating_min_output_power_0c',
            'sensor.eu08l_hp1_heating_max_output_power_0c',
            'sensor.eu08l_hp1_heating_min_output_power_minus15c',
            'sensor.eu08l_hp1_heating_max_output_power_minus15c',
            'sensor.eu08l_hp1_cooling_min_output_power',
            'sensor.eu08l_hp1_cooling_max_output_power',
            'sensor.eu08l_hp1_config_parameter_60'
          ] %}
          | Register | Name | Wert |
          |----------|------|------|
          {% for e in list %}
          {% if state_attr(e, 'register') is not none %}
          | R{{ state_attr(e, 'register') }} | {{ state_attr(e, 'friendly_name') or '—' }} | {{ states(e) }} {{ state_attr(e, 'unit_of_measurement') or '' }} |
          {% endif %}
          {% endfor %}

  - title: Warmwasser (Boiler)
    path: boil
    icon: mdi:water-thermometer
    cards:
      - type: markdown
        title: Boiler1 – Native Register
        content: |
          {% set list = [
            'sensor.eu08l_boil1_error_number',
            'sensor.eu08l_boil1_operating_state',
            'sensor.eu08l_boil1_actual_high_temperature',
            'sensor.eu08l_boil1_actual_low_temperature',
            'sensor.eu08l_boil1_actual_circulation_temperature',
            'sensor.eu08l_boil1_actual_circulation_pump_state',
            'sensor.eu08l_boil1_target_high_temperature'
          ] %}
          | Register | Name | Wert |
          |----------|------|------|
          {% for e in list %}
          {% if state_attr(e, 'register') is not none %}
          | R{{ state_attr(e, 'register') }} | {{ state_attr(e, 'friendly_name') or '—' }} | {{ states(e) }} {{ state_attr(e, 'unit_of_measurement') or '' }} |
          {% endif %}
          {% endfor %}

  - title: Heizkreis (HC1)
    path: hc1
    icon: mdi:radiator
    cards:
      - type: markdown
        title: HC1 – Native Register
        content: |
          {% set list = [
            'sensor.eu08l_hc1_error_number',
            'sensor.eu08l_hc1_operating_state',
            'sensor.eu08l_hc1_flow_line_temperature',
            'sensor.eu08l_hc1_return_line_temperature',
            'sensor.eu08l_hc1_room_device_temperature',
            'sensor.eu08l_hc1_set_flow_line_temperature',
            'sensor.eu08l_hc1_operating_mode',
            'sensor.eu08l_hc1_flow_line_temperature_setpoint',
            'sensor.eu08l_hc1_target_temp_flow_line',
            'sensor.eu08l_hc1_set_flow_line_offset_temperature',
            'sensor.eu08l_hc1_target_room_temperature',
            'sensor.eu08l_hc1_set_cooling_mode_room_temperature'
          ] %}
          | Register | Name | Wert |
          |----------|------|------|
          {% for e in list %}
          {% if state_attr(e, 'register') is not none %}
          | R{{ state_attr(e, 'register') }} | {{ state_attr(e, 'friendly_name') or '—' }} | {{ states(e) }} {{ state_attr(e, 'unit_of_measurement') or '' }} |
          {% endif %}
          {% endfor %}
